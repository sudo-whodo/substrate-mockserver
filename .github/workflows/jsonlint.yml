name: JSON Lint

on:
  pull_request:
    types: [ opened, synchronize, reopened ]
    paths:
      - '**/*.json'
  push:
    paths:
      - '**/*.json'
  workflow_dispatch:

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Validate JSON files
        run: |
          echo "Validating JSON files..."
          exit_code=0
          for file in mocks/*.json; do
            if [ -f "$file" ]; then
              echo "Checking $file..."
              if python -m json.tool "$file" > /dev/null 2>&1; then
                echo "✅ $file is valid JSON"
              else
                echo "❌ $file is invalid JSON"
                exit_code=1
              fi
            fi
          done

          if [ $exit_code -eq 0 ]; then
            echo "✅ All JSON files are valid!"
          else
            echo "❌ One or more JSON files are invalid"
            exit 1
          fi
